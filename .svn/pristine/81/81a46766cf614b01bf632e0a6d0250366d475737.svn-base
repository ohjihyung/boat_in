<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core"  prefix="c"%>
<!-- Topbar Start -->
<style>
.ag-theme-alpine {
    --ag-header-background-color: #FDE986;
    --ag-background-color: RGB(253, 248, 200);
    --ag-odd-row-background-color: RGB(253, 248, 200);
    --ag-foreground-color: black;
    
}
</style>
<div class="navbar-custom">
    <div class="container-fluid">
        <ul class="list-unstyled topnav-menu float-end mb-0">

            <li class="d-none d-lg-block">
                <form class="app-search">
                    <div class="app-search-box dropdown">
                        <div class="input-group">
                            <input type="search" class="form-control" placeholder="Search..." id="top-search">
                            <button class="btn input-group-text" type="submit">
                                <i class="fe-search"></i>
                            </button>
                        </div>
                        <div class="dropdown-menu dropdown-lg" id="search-dropdown">
                            <!-- item-->
                            <div class="dropdown-header noti-title">
                                <h6 class="text-overflow text-uppercase">Recent Searches</h6>
                            </div>

                            <div class="g-3 px-2 pb-2">
                                <a href="#!" class="btn btn-sm rounded-pill btn-light">profile <i class="fe-search ms-1"></i></a>
                                <a href="#!" class="btn btn-sm rounded-pill btn-light">yarn <i class="fe-search ms-1"></i></a>
                            </div>
            
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="fe-home me-1"></i>
                                <span>Analytics Report</span>
                            </a>
            
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="fe-aperture me-1"></i>
                                <span>How can I help you?</span>
                            </a>
                            
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item notify-item">
                                <i class="fe-settings me-1"></i>
                                <span>User profile settings</span>
                            </a>

                            <!-- item-->
                            <div class="dropdown-header noti-title">
                                <h6 class="text-overflow mb-2 text-uppercase">Users</h6>
                            </div>

                            <div class="notification-list">
                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <div class="d-flex align-items-start">
                                        <img class="d-flex me-2 rounded-circle" src="${pageContext.request.contextPath }/resources/dist/assets/images/users/user-2.jpg" alt="Generic placeholder image" height="32">
                                        <div class="w-100">
                                            <h5 class="m-0 font-14">Erwin E. Brown</h5>
                                            <span class="font-12 mb-0">UI Designer</span>
                                        </div>
                                    </div>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <div class="d-flex align-items-start">
                                        <img class="d-flex me-2 rounded-circle" src="${pageContext.request.contextPath }/resources/dist/assets/images/users/user-5.jpg" alt="Generic placeholder image" height="32">
                                        <div class="w-100">
                                            <h5 class="m-0 font-14">Jacob Deo</h5>
                                            <span class="font-12 mb-0">Developer</span>
                                        </div>
                                    </div>
                                </a>
                            </div>
            
                        </div>  
                    </div>
                </form>
            </li>
    
            <li class="dropdown d-inline-block d-lg-none">
                <a class="nav-link dropdown-toggle arrow-none waves-effect waves-light" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="fe-search noti-icon"></i>
                </a>
                <div class="dropdown-menu dropdown-lg dropdown-menu-end p-0">
                    <form class="p-3">
                        <input type="text" class="form-control" placeholder="Search ..." aria-label="Recipient's username">
                    </form>
                </div>
            </li>
    
            <li class="dropdown d-none d-lg-inline-block">
                <a class="nav-link dropdown-toggle arrow-none waves-effect waves-light" data-toggle="fullscreen" href="#">
                    <i class="fe-maximize noti-icon"></i>
                </a>
            </li>
            <li class="dropdown block">
                <a class="nav-link dropdown-toggle arrow-none waves-effect waves-light"  href="/letter/home">
                		 
                		<span class = " position-relative">
                		 <img alt="" src="/assets/images/letter.png" width="30"  class= " position-relative"> 
                		 <span id = "tobbarLetterCnt"class="chkletterinit position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                            
                           <span class="visually-hidden">unread messages</span>
                       </span> 
                       </span>
              </a>
            </li>
            <li class="dropdown block">
                <a class="nav-link dropdown-toggle arrow-none waves-effect waves-light" data-toggle="" href="#">
                    <button class="btn btn-primary mt-2 mt-md-0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
                    üéÅWidget           
                    </button>
                </a>
            </li>
    
            <li class="dropdown d-none d-lg-inline-block topbar-dropdown">
                <a class="nav-link dropdown-toggle arrow-none waves-effect waves-light" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <img src="${pageContext.request.contextPath }/resources/dist/assets/images/flags/us.jpg" alt="user-image" height="16">
                </a>
                <div class="dropdown-menu dropdown-menu-end">
    
                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item">
                        <img src="${pageContext.request.contextPath }/resources/dist/assets/images/flags/germany.jpg" alt="user-image" class="me-1" height="12"> <span class="align-middle">German</span>
                    </a>
    
    
                </div>
            </li>
            
            <li class="dropdown notification-list topbar-dropdown">
                <a class="nav-link dropdown-toggle waves-effect waves-light" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                    <i class="fe-bell noti-icon"></i>
                    <span class="badge bg-danger rounded-circle noti-icon-badge">5</span>
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-lg">
    
                    <!-- item-->
                    <div class="dropdown-item noti-title">
                        <h5 class="m-0">
                            <span class="float-end">
                                <a href="" class="text-dark">
                                    <small>Clear All</small>
                                </a>
                            </span>Notification
                        </h5>
                    </div>
    
                    <div class="noti-scroll" data-simplebar>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item active">
                            <div class="notify-icon">
                                <img src="${pageContext.request.contextPath }/resources/dist/assets/images/users/user-1.jpg" class="img-fluid rounded-circle" alt="" /> </div>
                            <p class="notify-details">Cristina Pride</p>
                            <p class="text-muted mb-0 user-msg">
                                <small>Hi, How are you? What about our next meeting</small>
                            </p>
                        </a>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-primary">
                                <i class="mdi mdi-comment-account-outline"></i>
                            </div>
                            <p class="notify-details">Caleb Flakelar commented on Admin
                                <small class="text-muted">1 min ago</small>
                            </p>
                        </a>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon">
                                <img src="${pageContext.request.contextPath }/resources/dist/assets/images/users/user-4.jpg" class="img-fluid rounded-circle" alt="" /> </div>
                            <p class="notify-details">Karen Robinson</p>
                            <p class="text-muted mb-0 user-msg">
                                <small>Wow ! this admin looks good and awesome design</small>
                            </p>
                        </a>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-warning">
                                <i class="mdi mdi-account-plus"></i>
                            </div>
                                <small class="text-muted">5 hours ago</small>
                            </p>
                        </a>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-info">
                                <i class="mdi mdi-comment-account-outline"></i>
                            </div>
                            <p class="notify-details">Caleb Flakelar commented on Admin
                                <small class="text-muted">4 days ago</small>
                            </p>
                        </a>
    
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item notify-item">
                            <div class="notify-icon bg-secondary">
                                <i class="mdi mdi-heart"></i>
                            </div>
                            <p class="notify-details">Carlos Crouch liked
                                <b>Admin</b>
                                <small class="text-muted">13 days ago</small>
                            </p>
                        </a>
                    </div>
    
                    <!-- All-->
                    <a href="javascript:void(0);" class="dropdown-item text-center text-primary notify-item notify-all">
                        View all
                        <i class="fe-arrow-right"></i>
                    </a>
    
                </div>
            </li>
    
            <li class="dropdown notification-list topbar-dropdown">
                <a class="nav-link dropdown-toggle nav-user me-0 waves-effect waves-light" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false" id="myProfileImg">
<%--                     	<img src="${pageContext.request.contextPath }/resources/dist/assets/images/users/blank_progile.png" alt="user-image" class="rounded-circle"> --%>
<!--                     <span class="pro-user-name ms-1"> -->
<!--                       <i class="mdi mdi-chevron-down"></i>  -->
<!--                     </span> -->
                </a>
                <div class="dropdown-menu dropdown-menu-end profile-dropdown ">
                    <!-- item-->
    
                    <!-- item-->
                    <a href="/mypage/home" class="dropdown-item notify-item">
                        <i class="fe-user"></i>
                        <span>My Page</span>
                    </a>
    
                    <!-- item-->
                    <a href="javascript:void(0);" class="dropdown-item notify-item">
                        <i class="fe-lock"></i>
                        <span>Lock Screen</span>
                    </a>
    
                    <div class="dropdown-divider"></div>
    
                    <!-- item-->
                    <a href="#" class="dropdown-item notify-item" onclick="logout_H();">
                        <i class="fe-log-out"></i>
                        <span>Logout</span>
                    </a>
    
                </div>
            </li>
    
            <li class="dropdown notification-list">
                <a href="javascript:void(0);" class="nav-link right-bar-toggle waves-effect waves-light">
                    <i class="fe-settings noti-icon"></i>
                </a>
            </li>
    
        </ul>
    
        <!-- LOGO -->
        <div class="logo-box">
            <a href="/dashboard" class="logo logo-dark text-center">
                <span class="logo-sm">
                    <img src="${pageContext.request.contextPath }/resources/dist/assets/images/logo-sm.png" alt="" height="22">
                    <!-- <span class="logo-lg-text-light">Codefox</span> -->
                </span>
                <span class="logo-lg">
                    <img src="${pageContext.request.contextPath }/resources/dist/assets/images/logo-dark.png" alt="" height="20">
                    <!-- <span class="logo-lg-text-light">U</span> -->
                </span>
            </a>
    
            <a href="/dashboard" class="logo logo-light text-center">
                <span class="logo-sm">
                    <img src="${pageContext.request.contextPath }/resources/dist/assets/images/logo-sm.png" alt="" height="22">
                </span>
                <span class="logo-lg">
                    <img src="${pageContext.request.contextPath }/resources/dist/assets/images/logo-light.png" alt="" height="20">
                </span>
            </a>
        </div>

		<ul
			class="list-unstyled topnav-menu topnav-menu-left m-0">
			<li>
				<button class="button-menu-mobile waves-effect waves-light">
					<i class="fe-menu"></i>
				</button>
			</li>

			<li>
				<!-- Mobile menu toggle (Horizontal Layout)--> <a
				class="navbar-toggle nav-link" data-bs-toggle="collapse"
				data-bs-target="#topnav-menu-content">
					<div class="lines">
						<span></span> <span></span> <span></span>
					</div>
			</a> <!-- End mobile menu toggle-->
			</li>

			<li class="dropdown d-none d-xl-block"><a
				class="nav-link dropdown-toggle waves-effect waves-light"
				data-bs-toggle="dropdown" href="#" role="button"
				aria-haspopup="false" aria-expanded="false"> Create New <i
					class="mdi mdi-chevron-down"></i>
			</a>
				<div class="dropdown-menu">
					<!-- item-->
					<a href="javascript:void(0);" class="dropdown-item"> <i
						class="fe-briefcase me-1"></i> <span>New Projects</span>
					</a>

					<!-- item-->
					<a href="javascript:void(0);" class="dropdown-item"> <i
						class="fe-user me-1"></i> <span>Create Users</span>
					</a>

					<!-- item-->
					<a href="javascript:void(0);" class="dropdown-item"> <i
						class="fe-bar-chart-line- me-1"></i> <span>Revenue Report</span>
					</a>

					<!-- item-->
					<a href="javascript:void(0);" class="dropdown-item"> <i
						class="fe-settings me-1"></i> <span>Settings</span>
					</a>

					<div class="dropdown-divider"></div>

					<!-- item-->
					<a href="javascript:void(0);" class="dropdown-item"> <i
						class="fe-headphones me-1"></i> <span>Help & Support</span>
					</a>

				</div></li>

			<li class="dropdown dropdown-mega d-none d-xl-block"><a
				class="nav-link dropdown-toggle waves-effect waves-light"
				data-bs-toggle="dropdown" href="#" role="button"
				aria-haspopup="false" aria-expanded="false"> Mega Menu <i
					class="mdi mdi-chevron-down"></i>
			</a>
				<div class="dropdown-menu dropdown-megamenu">
					<div class="row">
						<div class="col-sm-8">

							<div class="row">
								<div class="col-md-4">
									<h5 class="text-dark mt-0">UI Components</h5>
									<ul class="list-unstyled megamenu-list">
										<li><a href="javascript:void(0);">Widgets</a></li>
										<li><a href="javascript:void(0);">Nestable List</a></li>
										<li><a href="javascript:void(0);">Range Sliders</a></li>
										<li><a href="javascript:void(0);">Masonry Items</a></li>
										<li><a href="javascript:void(0);">Sweet Alerts</a></li>
										<li><a href="javascript:void(0);">Treeview Page</a></li>
										<li><a href="javascript:void(0);">Tour Page</a></li>
									</ul>
								</div>

								<div class="col-md-4">
									<h5 class="text-dark mt-0">Applications</h5>
									<ul class="list-unstyled megamenu-list">
										<li><a href="javascript:void(0);">eCommerce Pages</a></li>
										<li><a href="javascript:void(0);">CRM Pages</a></li>
										<li><a href="javascript:void(0);">Email</a></li>
										<li><a href="javascript:void(0);">Calendar</a></li>
										<li><a href="javascript:void(0);">Team Contacts</a></li>
										<li><a href="javascript:void(0);">Task Board</a></li>
										<li><a href="javascript:void(0);">Email Templates</a></li>
									</ul>
								</div>

								<div class="col-md-4">
									<h5 class="text-dark mt-0">Extra Pages</h5>
									<ul class="list-unstyled megamenu-list">
										<li><a href="javascript:void(0);">Left Sidebar with
												User</a></li>
										<li><a href="javascript:void(0);">Menu Collapsed</a></li>
										<li><a href="javascript:void(0);">Small Left Sidebar</a>
										</li>
										<li><a href="javascript:void(0);">New Header Style</a></li>
										<li><a href="javascript:void(0);">Search Result</a></li>
										<li><a href="javascript:void(0);">Gallery Pages</a></li>
										<li><a href="javascript:void(0);">Maintenance &
												Coming Soon</a></li>
									</ul>
								</div>
							</div>
						</div>
						<div class="col-sm-4">
							<div class="text-center mt-3">
								<h3 class="text-dark">Special Discount Sale!</h3>
								<h4>Save up to 70% off.</h4>
								<button class="btn btn-primary rounded-pill mt-3">Download
									Now</button>
							</div>
						</div>
					</div>

				</div></li>
		</ul>
		<div class="clearfix"></div>
    </div>
</div>
<!-- end Topbar -->

<!-- ÏúÑÏ†ØÎ∂ÄÎ∂Ñ -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
        <h5 id="offcanvasRightLabel">My Widget</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div> <!-- end offcanvas-header-->

    <div class="offcanvas-body">
        <div id="widget-time"></div>
        <div>
	        <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#bs-example-modal-lg"> + </button>
		    <button type="button" id="resetWidget" class="btn btn-danger waves-effect waves-light"> - </button>
	    </div>
		    <div 
		      class="container-widget-delete" 
		      id="dustbin" 
		      style="width: 100%; height: 150px; background-color: #ECF2F5; text-align: center;">
		      <h3 class="">Dustbin</h3>
		    </div>
        <div class="card" id="icon-widget"> <!--  style="display: flex; flex-direction: row;" -->
            <div class="card-body">
                <h4 class="header-title">ÎÇòÎßåÏùò ÏúÑÏ†ØÏùÑ Íµ¨ÏÑ±ÌïòÏÑ∏Ïöî!</h4>
            </div>
           <div id="widget-myList" class="container-widget"></div>
           
        </div>
       
        <div>
        </div>
    </div> <!-- end offcanvas-body-->
</div> <!-- end offcanvas-->

<!-- ÏúÑÏ†Ø Ï∂îÍ∞Ä Î™®Îã¨ -->
<!--  Modal content for the Large example -->
<div class="modal fade" id="bs-example-modal-lg" tabindex="-1" role="dialog"
    aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myLargeModalLabel">Widget List</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="widget-list"><!-- ÏúÑÏ†Ø Î¶¨Ïä§Ìä∏Îì§ Ï∂úÎ†•Ìï¥Ï£ºÍ∏∞ --></div>
                <div>
	                <button type="button" id="addWidget" class="btn btn-success waves-effect waves-light" data-bs-dismiss="modal" aria-label="Close">Add Widget</button>
	                <button type="button" id="" class="btn btn-danger waves-effect waves-light" data-bs-dismiss="modal" aria-label="Close">Close</button>
                </div>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->



<script>
//Î°úÍ∑∏Ïù∏Ïãú memberVO Í∞ùÏ≤¥Í∞Ä localÏóê Ï†ÄÏû•Îê©ÎãàÎã§. topbarÏóêÏÑú ÌôúÏö©ÌïòÏÑ∏Ïöî
//ÏúÑÏ†Ø ÏÑ†ÌÉùÎ¶¨Ïä§Ìä∏ Î™®Îã¨Ïóê ÎøåÎ¶¨Í∏∞

//ÏãúÏûëÌïòÏûêÎßàÏûê Ïã§ÌñâÌï† Í≤ÉÎì§  ÏÜåÏ∫£ÏúºÎ°ú Ïã§ÏãúÍ∞ÑÏïåÎûåÏúºÎ°ú ÏóÖÍ∑∏Î†àÏù¥ÎìúÌï†ÏòàÏ†ï
$(function(){
	checkletterCnt();
})

var memberId = localStorage.getItem('id');
var memberToken = localStorage.getItem('token');

getMemberDetail_B();

function getMemberDetail_B(){
	   var memberId ={
	         memberId : localStorage.getItem('id')
	   }
	   $.ajax({
	      url : "/member/selectMember",
	      type : "post",
	      data : JSON.stringify(memberId),
	      contentType : 'application/json; charset=utf-8',
	      dataType : 'json',
	      success : function(res) {
	         console.log(res)
	     	let Str = ""
				if(res.memberPic == 0){
					Str += `<img src="${pageContext.request.contextPath }/resources/dist/assets/images/users/blank_progile.png" alt="user-image" class="rounded-circle">`;
				}else{
					Str += `<img src="\${res.memberPic}" alt="user-image" class="rounded-circle">`;
				}
				Str += `<span class="pro-user-name ms-1">
			          \${res.memberName}<i class="mdi mdi-chevron-down"></i> 
			              </span>`;
			              
				myProfileImg.innerHTML = Str;
	      },
	   });//ajax
}


/* Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄ ÎπÑÏñ¥ÏûàÏúºÎ©¥ ÏùºÎã® Ï¥àÍ∏∞Ìôî */
window.addEventListener("DOMContentLoaded", (event) => {
	memberId = localStorage.getItem('id');
	memberToken = localStorage.getItem('token');
	memberPic = localStorage.getItem('pic');
	console.log(memberPic)
	
	if (memberId == null || memberId== '') {
		localStorage.removeItem('id');
	}else if (memberToken == null || memberToken == ''){
		localStorage.removeItem('token');
	}else if (memberPic == null || memberPic == ''){
		localStorage.removeItem('pic');
	}
    console.log("DOMContentLoaded");
});

	/* Î°úÍ∑∏ÏïÑÏõÉÍ≥º Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄ ÏÇ≠Ï†ú */
function logout_H(){
	var memberVO ={
	         memberId : localStorage.getItem('id')
	   }
	kakaoLogout();
	localStorage.removeItem('id');
	localStorage.removeItem('token');
	location.href= "/login"
		$.ajax({
			url : "/logout",
			type : "post",
			data : JSON.stringify(memberVO),
			contentType : 'application/json; charset=utf-8',
			dataType : 'json',
			success : function(res) {
				console.log("Î°úÍ∑∏ÏïÑÏõÉ : "+ res)
				
			},

		});//ajax
}
//Ïπ¥Ïπ¥Ïò§Î°úÍ∑∏ÏïÑÏõÉ
Kakao.init('cbfd91d2833351668be647432e1a4c13'); //Î∞úÍ∏âÎ∞õÏùÄ ÌÇ§ Ï§ë javascriptÌÇ§Î•º ÏÇ¨Ïö©Ìï¥Ï§ÄÎã§.
function kakaoLogout() {
    if (Kakao.Auth.getAccessToken()) {
      Kakao.API.request({
        url: '/v1/user/unlink',
        success: function (response) {
        	console.log(response)
        },
        fail: function (error) {
          console.log(error)
        },
      })
      Kakao.Auth.setAccessToken(undefined)
    }
  }  
	
////////////////// ÏúÑÏ†Ø Í¥ÄÎ†® - ÍπÄÏßÑÌò∏

//Î†åÎçîÎßÅ Ìï®Ïàò
renderWidgetList_K(); //ÏÑ±Í≥µ
renderWidgetBar_K(); //ÏÑ±Í≥µ

var btnAddWidget_K = document.querySelector("#addWidget");
var btnResetWidget_K = document.querySelector("#resetWidget");

/* ÎÇ†Ïî® API ÏãúÏûë */
var API_KEY_WEATHER = "26329357974be09d714c1296fe958784";
function onGeoOk(position) {
    const lat = position.coords.latitude; //userÏùò ÏúÑÎèÑ
    const lon = position.coords.longitude; //userÏùò Í≤ΩÎèÑ
    const url = "https://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon="
                 + lon + "&appid=" + API_KEY_WEATHER + "&units=metric";
            
    fetch(url)
        .then(response => response.json())
        .then(data => {
            //console.log(data.name, data.weather[0].main);
            const weather = document.querySelector("#widget-weather span:first-child");
            const city = document.querySelector("#widget-weather span:last-child");
            weather.innerHTML = "<h2>ÎÇ†Ïî® üåû  " + data.weather[0].main + " / üå°" +data.main.temp + "¬∞C</h2>";
            city.innerHTML = "<h2>Ï†ëÏÜç ÏßÄÏó≠ üåç" + data.name + "</h2>";
        });
}

function onGeoError() {
    alert("Can't find you. No weater for you.");
}
/* ÎÇ†Ïî® ÎÅù */

/* ÏãúÍ≥Ñ API ÏãúÏûë */
function getClock() {
    const date = new Date();
    const hours = String( date.getHours() ).padStart(2, "0");
    const minutes = String( date.getMinutes() ).padStart(2, "0");
    const seconds = String( date.getSeconds() ).padStart(2, "0");
    const clock = document.querySelector("#widget-time");
    clock.innerHTML = `<h4>ÌòÑÏû¨ ÏãúÍ∞Ñ : \${hours } : \${minutes} : \${seconds}</h4>`;
}

getClock();
setInterval(getClock, 1000);
/* ÏãúÍ≥Ñ ÎÅù */

// AG GRID API ÏãúÏûë
var columnDefs = [
	  {headerName: "Title", field: "title"},
	  {headerName: "Date", field: "date"},
	];
// specify the data
var rowData = [
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
  {title: "Î©îÎ™®Ïû•ÏûÑ", date: "Ïò§Îäò"},
];
// let the grid know which columns and what data to use
var gridOptions = {
	columnDefs: columnDefs,
       rowData: rowData,
       defaultColDef: {
         // Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ïª¨ÎüºÏóê Ï†ÅÏö©Ìï† ÏòµÏÖò ÏÑ†ÌÉù
         sortable: false,
         filter: true,
         // resizable:true,
         editable: false, // Î≥¥ÌÜµ gridÏ≤òÎüº ÌïúÎ≤àÏóê ÎßéÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Î≥¥Ïó¨Ï£ºÎäî Í≤ΩÏö∞ viewÎ°úÎßå ÏÇ¨Ïö©ÌïòÍ≥† ÏàòÏ†ï/ÏÇ≠Ï†úÎäî Î≥ÑÎèÑÎ°ú Ï≤òÎ¶¨Ìï®
       },
       pagination: true,
       statusBar: false,
       // paginationAutoPageSize:true,
       enableColResize: true,
       paginationPageSize: 6,
       localeText: "ÏûëÏÑ±Îêú Î©îÎ™®Í∞Ä ÏóÜÏäµÎãàÎã§.",
       onCellClicked: (merong) => alert("ÏïàÎÖïÏïàÎÖï! ÎÇòÎäî " + merong.data.name),
     };

// setup the grid after the page has finished loading
// AG GRID ÎÅù
      
//Ï∞®Ìä∏ API
//Ï∞®Ìä∏ ÏòµÏÖò
var optionsProjectChart_K = {
  series: [
	  {
	    name: 'ÏßÑÌñâÎèÑ',
	    data: [
	      {
	        x: 'ÌîåÏ†ù1',
	        y: 12,
	        goals: [
	          {
	            name: 'ÎßàÍ∞êÍ∏∞Ìïú',
	            value: 14,
	            strokeWidth: 2,
	            strokeDashArray: 2,
	            strokeColor: 'red'
	          }
	        ]
	      },
	      {
	        x: 'ÌîåÏ†ù2',
	        y: 44,
	        goals: [
	          {
	            name: 'ÎßàÍ∞êÍ∏∞Ìïú',
	            value: 54,
	            strokeWidth: 5,
	            strokeHeight: 10,
	            strokeColor: 'red'
	          }
	        ]
	      },
	      {
	        x: 'ÌîåÏ†ù3',
	        y: 54,
	        goals: [
	          {
	            name: 'ÎßàÍ∞êÍ∏∞Ìïú',
	            value: 52,
	            strokeWidth: 10,
	            strokeHeight: 0,
	            strokeLineCap: 'round',
	            strokeColor: 'red'
	          }
	        ]
	      },
	    ]
	  }
	],
chart: {
height: 200,
	type: 'bar'
	},
	plotOptions: {
	  bar: {
	    horizontal: true,
	  }
	},
	colors: ['#00E396'],
	dataLabels: {
	  formatter: function(val, opt) {
	    const goals =
	      opt.w.config.series[opt.seriesIndex].data[opt.dataPointIndex]
	        .goals
	
	    if (goals && goals.length) {
	      return `${val} / ${goals[0].value}`
	    }
	    return val
	  }
	},
	legend: {
	  show: true,
	  showForSingleSeries: true,
	  customLegendItems: ['ÏßÑÌñâÎèÑ', 'ÎßàÍ∞êÏùº'],
	  markers: {
	    fillColors: ['#00E396', 'red']
	  }
	}
};
//Ï∞®Ìä∏-ÌîÑÎ°úÏ†ùÌä∏ ÎÅù
//Ï∞®Ìä∏-ÎÇòÏùò ÏûëÏóÖ ÏãúÏûë
var optionsMyChart_K = {
  series: [
  {
    data: [
      {
        x: 'Analysis',
        y: [
          new Date('2019-02-27').getTime(),
          new Date('2019-03-04').getTime()
        ],
        fillColor: '#008FFB'
      },
      {
        x: 'Design',
        y: [
          new Date('2019-03-04').getTime(),
          new Date('2019-03-08').getTime()
        ],
        fillColor: '#00E396'
      },
      {
        x: 'Coding',
        y: [
          new Date('2019-03-07').getTime(),
          new Date('2019-03-10').getTime()
        ],
        fillColor: '#775DD0'
      },
      {
        x: 'Testing',
        y: [
          new Date('2019-03-08').getTime(),
          new Date('2019-03-12').getTime()
        ],
        fillColor: '#FEB019'
      },
      {
        x: 'Deployment',
        y: [
          new Date('2019-03-12').getTime(),
          new Date('2019-03-17').getTime()
        ],
        fillColor: '#FF4560'
      }
    ]
  }
],
  chart: {
  height: 200,
  type: 'rangeBar'
},
plotOptions: {
  bar: {
    horizontal: true,
    distributed: true,
    dataLabels: {
      hideOverflowingLabels: false
    }
  }
},
dataLabels: {
  enabled: true,
  formatter: function(val, opts) {
    var label = opts.w.globals.labels[opts.dataPointIndex]
    var a = moment(val[0])
    var b = moment(val[1])
    var diff = b.diff(a, 'days')
    return label + ': ' + diff + (diff > 1 ? ' days' : ' day')
  },
  style: {
    colors: ['#f3f4f5', '#fff']
  }
},
xaxis: {
  type: 'datetime'
},
yaxis: {
  show: false
},
grid: {
  row: {
    colors: ['#f3f4f5', '#fff'],
    opacity: 1
  }
}
};

//Ïò§ÌîÑÏ∫îÎ≤ÑÏä§
function offCanvasListener(offCanvasId) {
  let myOffCanvas = document.getElementById(offCanvasId);

  const hideCanvas = () => {
    let openedCanvas = bootstrap.Offcanvas.getInstance(myOffCanvas);
    openedCanvas.hide();
    event.target.removeEventListener('mouseleave', hideCanvas);
  }
  const listenToMouseLeave = (event) => {
    event.target.addEventListener('mouseleave', hideCanvas);
  }
  
  myOffCanvas.addEventListener('shown.bs.offcanvas', listenToMouseLeave);
}

//offCanvasListener('offcanvasRight');

//ÏúÑÏ†Ø Ï∂îÍ∞Ä Î≤ÑÌäº
btnAddWidget_K.addEventListener("click", () => {
    const selectedWidget = document.querySelectorAll(".widget");
    console.log("ÏúÑÏ†ØÏÑ†ÌÉù", selectedWidget);
    
    const addWidgetList = [];
    
    for (item of selectedWidget) {
        console.log("Ï≤¥ÌÅ¨Ïó¨Î∂Ä", item.checked);
        //console.dir(item.classList[2].split("-")[1]); Ïù¥Í≤å widgetNo.
        if (item.checked) {
            //console.log("Ï∂îÍ∞ÄÌïú ÏúÑÏ†Ø ÌÅ¥ÎûòÏä§ : ", item.classList[2]);
            let widgetNo = item.classList[2].split("-")[1];
            
            let widgetVO = {
                widgetNo
            };
            
            addWidgetList.push(widgetVO);
        }
        
    }
    //console.log("addWidgetList", addWidgetList);
    //ÏÑ†ÌÉùÌïú Í∞ùÏ≤¥Í∞Ä Îã¥Í∏¥ Î∞∞Ïó¥ ÎÑòÍ≤®Ï£ºÍ∏∞
    saveWidget_K(addWidgetList);
    renderWidgetList_K();
    document.querySelector("#bs-example-modal-lg").classList.remove("show");
    document.querySelector("#bs-example-modal-lg").style.display = "none";
});

//Ï∂îÍ∞Ä Í∞ÄÎä•Ìïú ÏúÑÏ†Ø Î¶¨Ïä§Ìä∏ ÎßåÎì§Í∏∞ -> Ïù¥ÎØ∏ ÏÇ¨Ïö©Ï§ëÏù∏Í±∞ Ï≤òÎ¶¨Ìï¥Ï£ºÍ∏∞
function renderWidgetList_K() {
    const target = document.querySelector("#widget-list");
    
    axios
      .get("/widget/list")
      .then((res) => {
          console.log("ÎÑòÏñ¥Ïò§Îäî Î¶¨Ïä§Ìä∏Î™©Î°ù : ", res);
          const json = res.data;
          const renderWidgetList = [];
          const renderWidgetList2 = [];
          const renderWidgetList3 = [];
          
          let text = "";
         //ÌÉúÍ∑∏ Í∑∏Î¶¨Í∏∞ Ï†Ñ ÎÇ¥ Î™©Î°ù Î®ºÏ†Ä ÌôïÏù∏ÌïòÍ∏∞
         const widgetBarVO = {
           memberId,
         };
         
         axios
           .post("/widget/myWidgetList", widgetBarVO)
           .then((result) => {
        	     console.log("ÎÇ¥Í∞Ä Ïì∞Îäî ÏúÑÏ†ØÎì§ : ", result.data );
        	     console.log("Ï†ÑÏ≤¥ÏúÑÏ†Ø Î¶¨Ïä§Ìä∏ : ", json);
        	     let myWidgetList = result.data;
        	     
        	     //ÎÇòÏùò Î¶¨Ïä§Ìä∏ÏôÄ Í∞ôÏúºÎ©¥ Î¶¨Ïä§Ìä∏Ïóê Ï∂îÍ∞Ä. (ÎÇòÏùò Î¶¨Ïä§Ìä∏ÏôÄ ÎèôÏùºÌïòÍ≤å Íµ¨ÏÑ±ÎêòÍ≤üÎÑ§..)
        	     for (let i = 0; i < myWidgetList.length; i++) {
        	    	 //ÌååÏù∏Îìú, ÌïÑÌÑ∞Îäî Ï†ÅÏ†àÌïòÏßÄ ÏïäÏùå.
        	    	 //Ï†ÑÏ≤¥Î¶¨Ïä§Ìä∏ ÏàúÌôòÌïòÎ©¥ÏÑú ÎÇ¥ Î¶¨Ïä§Ìä∏ÏôÄ ÏùºÏπòÌïòÎäîÍ±¥ Ï†úÏô∏ÌïòÍ∏∞
        	    	 json.forEach((item, index) => {
        	    		if (item.widgetNo == myWidgetList[i].widgetNo) {
        	    			json.splice(index, 1);
        	    		} 
        	    	 });
        	     }
        	     console.log("json : ", json);
        	     
		         //ÎÇ¥Í∞Ä Ïù¥ÎØ∏ Ïì∞Îäî ÏúÑÏ†ØÎì§ÏùÄ ÏïÑÏòà ÏïàÎú∏		         
		         for (item of json) {
		        	 console.log("Í∑∏Î¶¥ ÏïÑÏù¥ÌÖú : ", item); //ÏïàÏ∞çÌòîÎçò Ïù¥Ïú†Îäî ÎπÑÎèôÍ∏∞ ÏïàÏóêÏÑú Ïã§ÌñâÏùÑ ÏïàÌï¥ÏÑú..
		              text += `<div class="form-check mb-2 form-check-primary">`;
		              text += `<input class="form-check-input widget widgetList-\${item.widgetNo}" type="checkbox" value="\${item.widgetName}" id="customckeck-\${item.widgetName}">`;
		              text += `<label class="form-check-label" for="customckeck-\${item.widgetName}">\${item.widgetName}</label>`;
		              text += `</div>`;
		          }
		         //ÏãúÍ∞ÑÎê†Îïå ÏÇ¨Ïö©Ï§ëÏù∏ Î¶¨Ïä§Ìä∏ÎèÑ Ï∂úÎ†•Ìï¥Ï£ºÎèÑÎ°ù? -> Ïù¥Í±¥ ÎÇòÏùò ÏøºÎ¶¨Î°ú xx ÏøºÎ¶¨ÏàòÏ†ï
		         for (item of myWidgetList) {
		              text += `<div class="form-check mb-2">`;
		              text += `<input class="form-check-input widget widgetList-\${item.widgetNo}" type="checkbox" value="\${item.widgetName}" id="customckeck-\${item.widgetName}" disabled>`;
		              text += `<label class="form-check-label" for="customckeck-\${item.widgetName}">\${item.widgetName}</label>`;
		              text += `</div>`;
		         }
		         
		          target.innerHTML = text;
           });
         
      });
}

//ÌöåÏõêÏùò ÏúÑÏ†Ø Î¶¨Ïä§Ìä∏ Ï†ÄÏû•ÌïòÍ∏∞
function saveWidget_K(addWidgetList) { //Ïó¨Í∏∞ÏÑú ÎÑ§Í∞úÎßå Îì§Ïñ¥Í∞ÄÎ©¥ ÏïàÎê®. -> save Î≤ÑÌäº ÎßêÍ≥† add Î≤ÑÌäºÏúºÎ°ú Ï∂îÍ∞ÄÏôÄ ÎèôÏãúÏóê Ï†ÄÏû•Ìï¥ÏïºÌï†ÎìØ.
	//Ïö∞ÏÑ† ÌòÑÏû¨ divÎÇ¥Ïö© ÌÉêÏÉâ
	//const wList = document.querySelector("#widget-myList");
	//console.log("addWidgetList");
	//console.log(addWidgetList);//widgetNo Îã¥Í≤®ÏûàÏùå.
	
	for (let i = 0; i < addWidgetList.length; i++) {
		//Ïö∞ÏÑ†ÏùÄ Ï¶êÍ≤®Ï∞æÍ∏∞ Î™©Î°ù ÏóÜÏù¥ Îã®Ïùº Î™©Î°ùÏúºÎ°ú Í∞úÎ∞ú ÏãúÏûë
		//ÏúÑÏ†ØÎ≥ÑÎ°ú Í∞ÅÍ∞Å ÌïúÎ≤àÏî© inset Îì§Ïñ¥Í∞ÄÏïºÌï®. 
		let widgetNo = addWidgetList[i].widgetNo;
		let widgetBarVO = {
		  widgetNo,
		  memberId,
		  widgetBarTitle: "ÌÖåÏä§Ìä∏ÏúÑÏ†ØÎ∞î"
		};
		
		axios
		  .post("/widget/insertWidgetBar", widgetBarVO)
		  .then((res) => {
			  //console.log(res);ÏúÑÏ†ØÎ∞îÏóê Îì±Î°ù ÏÑ±Í≥µ
			  renderWidgetBar_K();
		  });
	}
}

//Ìï¥Îãπ ÌöåÏõêÏùò ÏúÑÏ†Ø Î¶¨Ïä§Ìä∏ Î∂àÎü¨Ïò§Í∏∞
function renderWidgetBar_K() {
	//console.log("ÏúÑÏ†Ø Î†åÎçîÌï† Î©§Î≤Ñ ÏïÑÏù¥Îîî : ", memberId);
	const widgetBarVO = {
	  memberId,
	};
	
	axios
	  .post("/widget/myWidgetList", widgetBarVO)
	  .then((res) => {
		//console.log("ÎÇ¥ ÏúÑÏ†ØÎ™©Î°ù : ", res.data); //Ïûò Í∞ÄÏ†∏Ïò¥. Ïù¥Ï†ú Ïù¥Í±∏ ÌÜ†ÎåÄÎ°ú Í∑∏Î†§Ï§òÏïºÌï®.
		
		renderWidgetItem_K(res.data);
	  });
}

function renderWidgetItem_K(widgetList) { //+= Î∞©ÏãùÏù¥ ÏïÑÎãàÎùº + Î∞©ÏãùÏúºÎ°ú..
	let text = "";
	const selectList = [];
	
	for (item of widgetList) {
		//Î©îÎ™®Ïû•
		if (item.widgetNo == 1) {
			selectList.push("memo");
            text += `<div id="widget-memo" style="height: 200px; width: 100%;" class="widgetNo-1 widgetBarNo-\${item.widgetBarNo} ag-theme-alpine">`;
            text += `</div>`;
        }  
        //ÎÇ†Ïî®
        if (item.widgetNo == 2) {
        	selectList.push("weather");
            text += `<div id="widget-weather" class="widgetNo-2 widgetBarNo-\${item.widgetBarNo}">`;
            text += ` <span style="color: black;"></span>`;
            text += ` <span style="color: black;"></span>`;
            text += `</div>`;
        }
        
        //Ï∞®Ìä∏ - ÌîÑÎ°úÏ†ùÌä∏
        if (item.widgetNo == 4) {
        	selectList.push("chart-project");
            text += `<div id="widget-chart-project" class="widgetNo-4 widgetBarNo-\${item.widgetBarNo}"></div>`;
        }
        //Ï∞®Ìä∏ - ÎÇòÏùò ÏùºÍ∞ê
        if (item.widgetNo == 5) {
        	selectList.push("chart-myTopWork");
            text += `<div id="widget-chart-myTopWork" class="widgetNo-5 widgetBarNo-\${item.widgetBarNo}"></div>`;
        }
	}
	
	document.querySelector("#widget-myList").innerHTML = text;
	
	if (selectList.includes("memo")) {
        var gridDiv = document.querySelector('#widget-memo');
        new agGrid.Grid(gridDiv, gridOptions);
    }
    
    if (selectList.includes("weather")) {
        //success Ìï®ÏàòÏôÄ error Ìï®ÏàòÎ•º Ïù∏ÏûêÎ°ú Î∞õÏùå.
        navigator.geolocation.getCurrentPosition(onGeoOk, onGeoError);
    }
    
    if (selectList.includes("chart-project")) {
        var chartProject = new ApexCharts(document.querySelector("#widget-chart-project"), optionsProjectChart_K);
        chartProject.render();
    }
    
    if (selectList.includes("chart-myTopWork")) {
        var chartMy = new ApexCharts(document.querySelector("#widget-chart-myTopWork"), optionsMyChart_K);
        chartMy.render();
    }
    
    //ÏúÑÏ†Ø Îã§ Í∑∏Î¶¨Í≥† ÎìúÎûòÍ∑∏ Ïù¥Î≤§Ìä∏ Í±∏Í∏∞
    const container = document.querySelector(".container-widget");
    const containerSideBar = document.querySelector(".container-widget2");
    const containerDustbin = document.querySelector(".container-widget-delete");
    
    new Sortable(container, {
        group: {
            name: "shared", //Ïù¥Í≤å Í∞ôÏùÄ Sortable Í∞ùÏ≤¥Îì§ÎÅºÎ¶¨ Ïù¥Îèô Í∞ÄÎä•
          },
          swapThreshold: 1,
          animation: 150,
          ghostClass: "blue-background-class",
          //sort: false, Ïù¥Í±∞ falseÌïòÎ©¥ ÏõêÎûò ÏòÅÏó≠ ÎÇ¥ÏóêÏÑúÎäî ÏïàÏõÄÏßÅÏûÑ
          onChoose: function (event) {
            //ÌÅ¥Î¶≠Ìïú ÏïÑÏù¥ÌÖú
            //ÏÑ†ÌÉùÌïú ÏòÅÏó≠ ÏïàÏóê ÌÖåÏù¥Î∏î Î™©Î°ù
            //console.log("ÏãúÏûë~~~"); //Í∑ºÎç∞ ÎßàÏö∞Ïä§Í∞Ä Îñ†ÎÇòÏïºÎßå Ïù¥Í≤å Ïã§ÌñâÎêòÏñ¥Ïïº Ìï®... Í∑ºÎç∞ ÎìúÎûòÍ∑∏ ÏãúÏûëÌïòÎ©¥ Î™ªÏû°Ïùå..?
            function delay() {
                let myOffCanvas = document.querySelector("#offcanvasRight"); 
                let openedCanvas = bootstrap.Offcanvas.getInstance(myOffCanvas);
                openedCanvas.hide();
            }
            
            //setTimeout(delay, 1000);
          },
          filter: ".filtered",
          onEnd: function (event) {
            //ÎÇ¥Î†§ÎÜìÏïòÏùÑÎïå!
            ////////////////////////////////////////////////////////////////////////
            // ÏúÑÏ†Ø Ïù¥ÎèôÏãú ÏúÑÏπò Ïû°ÏïÑÏ£ºÍ∏∞  
            ////////////////////////////////////////////////////////////////////////
            //console.log("ÎÇ¥Î†§ÎÜìÏùÄ Í≥≥", event.item);
            //console.log("ÎÇ¥Î†§ÎÜìÏùÄ Í≥≥ Î∂ÄÎ™® : ", event.item.parentElement);
            const parentDiv = event.item.parentElement
            //console.log("Î∂ÄÎ™® ÎîîÎ∏åÏïÑÏù¥Îîî : ", parentDiv.id);
            
            //ÏÇ≠Ï†úÏùºÎïåÎäî ÏòàÏô∏ Ï≤òÎ¶¨
            if (parentDiv.id == "dustbin") {
            	//console.log("Ïù¥ Ìï®ÏàòÎäî Îπ†Ï†∏ÎÇòÍ∞ëÎãàÎã§.");
            	return;
            }
            
            const arr = parentDiv.children;
            //console.log(arr); //ÏûêÏãù ÏàúÏÑúÎåÄÎ°ú ÎΩëÌûò.
            for (let i = 0; i < arr.length; i++) {
            	//console.log(`\${i}Î≤àÏß∏ ÏûêÏãù : `,arr[i]);
            	let moveChild = arr[i].classList[1]; //widgetBarNo-1 Ïù¥Îü∞ÏãùÏúºÎ°ú ÎΩëÌûò.
            	let widgetBarNo = moveChild.split("-")[1];
            	console.log("widgetBarNo : ", moveChild, " ÏúÑÏπò : ", i); //ÏúÑÏπò Í∞íÏùÄ 0Î∂ÄÌÑ∞ ÏãúÏûëÌïòÎäîÍ±∏Î°úÌïòÏûê.
            	let widgetBarVO = {
            		widgetBarNo,
            		widgetWBLocation: i
            	};
            	//Î∞òÎ≥µÎ¨∏ ÏïàÏóêÏÑú Î≥¥ÎÇ¥ÏïºÌï®
            	console.log("Î≥¥ÎÇº Í∞ùÏ≤¥ : ", widgetBarVO);
            	axios
            	  .post("/widget/moveWidget", widgetBarVO)
            	  .then((res) => {
            		  console.log(res);
            	  });
            }
            
          },
          onAdd: function (event) {
        	  //console.log("ÎìúÎûç? : ", event);
          },
          onMove: function(event) {
        	  //console.log("Î¨¥Î∏å : ", event);
          }
    });
    new Sortable(containerSideBar, { //Î∞îÍπ• ÏÇ¨Ïù¥ÎìúÎ∞îÏòÅÏó≠
        group: {
            name: "shared", //Ïù¥Í≤å Í∞ôÏùÄ Sortable Í∞ùÏ≤¥Îì§ÎÅºÎ¶¨ Ïù¥Îèô Í∞ÄÎä•
          },
          swapThreshold: 1,
          animation: 150,
          ghostClass: "blue-background-class",
          //sort: false, Ïù¥Í±∞ falseÌïòÎ©¥ ÏõêÎûò ÏòÅÏó≠ ÎÇ¥ÏóêÏÑúÎäî ÏïàÏõÄÏßÅÏûÑ
          onChoose: function (event) {
            //ÌÅ¥Î¶≠Ìïú ÏïÑÏù¥ÌÖú
            //ÏÑ†ÌÉùÌïú ÏòÅÏó≠ ÏïàÏóê ÌÖåÏù¥Î∏î Î™©Î°ù
            //console.log("ÏãúÏûë~~~");
          },
          filter: ".filtered",
          onEnd: function (event) {
            //ÎÇ¥Î†§ÎÜìÏïòÏùÑÎïå!
          },
    });
    new Sortable(containerDustbin, {
        group: {
            name: "shared", //Ïù¥Í≤å Í∞ôÏùÄ Sortable Í∞ùÏ≤¥Îì§ÎÅºÎ¶¨ Ïù¥Îèô Í∞ÄÎä•
          },
          swapThreshold: 1,
          animation: 150,
          ghostClass: "blue-background-class",
          filter: ".filtered",
          //sort: false, Ïù¥Í±∞ falseÌïòÎ©¥ ÏõêÎûò ÏòÅÏó≠ ÎÇ¥ÏóêÏÑúÎäî ÏïàÏõÄÏßÅÏûÑ
          onChoose: function (event) {
            //ÌÅ¥Î¶≠Ìïú ÏïÑÏù¥ÌÖú
            //ÏÑ†ÌÉùÌïú ÏòÅÏó≠ ÏïàÏóê ÌÖåÏù¥Î∏î Î™©Î°ù
            //console.log("ÏãúÏûë~~~");
          },
          onEnd: function (event) {
        	  console.log(event.item);
            //ÎÇ¥Î†§ÎÜìÏïòÏùÑÎïå!
          },
          onAdd: function (event) {
        	  //ÏïÑÏù¥ÌÖúÏù¥ Ìú¥ÏßÄÌÜµÏóê Îì§Ïñ¥Í∞îÏùÑ Îïå!
              //console.dir(event.item);
              //console.log(event.item);
        	  //console.log("ÎÇ¥ÏïÑÏù¥Îîî : ", memberId, "widgetNo : ", event.item.classList[0].split("-")[1]);
        	  let widgetBarNo = event.item.classList[1].split("-")[1];
        	  let widgetNo = event.item.classList[0].split("-")[1];
        	  //console.log("widgetBarNo", widgetBarNo)
        	  const widgetBarVO = {
        		memberId,
        		widgetNo,
        		widgetBarNo
        	  };
        	  
        	  axios
        	    .post("/widget/deleteWidgetBar", widgetBarVO)
        	    .then((res) => {
        	    	//console.log(res); ÏÇ≠Ï†ú Ïûò Îê®. 
        	    	//ÏÇ≠Ï†ú ÎêêÏúºÎ©¥ Ìú¥ÏßÄÌÜµ ÎπÑÏö∞Í∏∞ + Îã§Ïãú Í∑∏Î†§Ï£ºÍ∏∞
        	    	document.querySelector("#dustbin").innerHTML = `<h3 class="">Ìú¥ÏßÄÌÜµ</h3>`;  	    	
        	    	renderWidgetBar_K();
        	    	renderWidgetList_K();
        	    });
        	  
          },
    });
    
};


/* Ï™ΩÏßÄ cnt ÏóÖÎç∞Ïù¥Ìä∏ */
function checkletterCnt(){
	var memberId = localStorage.getItem('id');
	var letterVO = {
		memberId : memberId
	}
	$.ajax({
		url : "/letter/mylist",
		type : "post",
		data : JSON.stringify(letterVO),
		contentType : 'application/json; charset=utf-8',
		dataType : 'json',
		success : function(res) {
			var checkCnt = 0;
			console.log(res)
			for (var i = 0; i < res.length; i++) {
				if (res[i].letterCheck =='0' && res[i].letterDelstate == '0') {
					checkCnt += 1;
				}
			}
			console.log("ÏïàÏùΩÏùÄÌé∏ÏßÄ:"+checkCnt);
			$('.chkletterinit').text(checkCnt)
			
		},
	});//ajax
}

</script>